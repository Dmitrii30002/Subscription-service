# Сервис подписок

Subscription service - gRPC сервис, который реализует сервис подписок. Данный сервис построен на основе пакета subpub. В данном пакете реализована шина событий, работающая по принципу Publisher-Subscriber. С помощью данного сервиса можно подписаться на событие, а после получить сообщение о публикации данного события. Шина работает ассинхроно и принимает сообщения в порядке FIFO, благодаря ассинхронности медленные подписчики не тормозят быстрых. С помощью пакета sync и каналов предотвращена утечка горутин. Для тестирования данного модуля были прописаны unit тесты. При необходимости, можно завершить работу сервиса. Завершение работы реализуется, с помощью паттерна Graceful shutdown. Так же для интегрированного тестирования был написан клиент для сервера. Проект можно поднять в контейнере с помощью докера, для этого был прописан Dockerfile.

## Установка и запуск
Клонирования репозитория
```console
git clone https://github.com/Dmitrii30002/Subscription-service.git
```

Создание docker образа
```console
docker build -t subscription_service_image . 
```

Запуск контейнера на основе нашего образа
```console
docker run subscription_service_image
```

## Тестирование
Для тестирования сервиса был написан клиент. Также для пакета subpub были прописаны unit-тесты.
Запуск тестирования
```console
cd pkg/subpub
go test -v
```

## Конфигурации
Конфигурации к данному проекту задаются с помощью файла config.yaml. В конфиге можно прописать такие параметры как: хост, порт и тип подключения для gRPC сервера, а так же указать уровень логирования(info, debug, warning, error, fatal).

## Логирование
Логирование происходит с помощью пакета logrus. Присутствует настройка уровня логирования.

## Структура проекта
```
Subscription_service/
│
├── cmd/                      # Содержит файл запуска сервера
│   └── main.go               # Точка входа
│
├── pkg/                      # Исходный код
│   ├── supBub/               # Пакеты проекта
│       └── subpub.go         # Пакет subpub
│
├── config/                   # Пакет конфигурации
│
├── server/                   # gRPC сервер
│
├── client/                   #  клиент для gRPC сервиса 
│
├── proto/                    # Содержит файл proto и генерированные файлы .go
├── config.yaml               # Пример конфиг
├── LICENSE                   # Лицензия 
└── README.md
```

